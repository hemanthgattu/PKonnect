{"ast":null,"code":"var graph = require('@microsoft/microsoft-graph-client');\n\nfunction getAuthenticatedClient(accessToken) {\n  // Initialize Graph client\n  const client = graph.Client.init({\n    // Use the provided access token to authenticate\n    // requests\n    authProvider: done => {\n      done(null, accessToken.accessToken);\n    }\n  });\n  return client;\n}\n\nexport async function getUserDetails(userId, accessToken) {\n  const client = getAuthenticatedClient(accessToken);\n  const user = await client.api('/' + userId).get();\n  return user;\n}\nexport async function getUserPhoto(userId, accessToken) {\n  var url = 'https://graph.microsoft.com/v1.0/' + userId + '/photo/$value';\n  return fetch(url, {\n    method: 'GET',\n    headers: {\n      Authorization: 'Bearer ' + accessToken.accessToken,\n      'Content-Type': 'application/json'\n    }\n  });\n}","map":{"version":3,"sources":["C:\\Development\\PKonnect\\PKonnect\\PKonnect.UI\\ClientApp\\src\\services\\GraphService.js"],"names":["graph","require","getAuthenticatedClient","accessToken","client","Client","init","authProvider","done","getUserDetails","userId","user","api","get","getUserPhoto","url","fetch","method","headers","Authorization"],"mappings":"AAAA,IAAIA,KAAK,GAAGC,OAAO,CAAC,mCAAD,CAAnB;;AAEA,SAASC,sBAAT,CAAgCC,WAAhC,EAA6C;AACzC;AACA,QAAMC,MAAM,GAAGJ,KAAK,CAACK,MAAN,CAAaC,IAAb,CAAkB;AAC7B;AACA;AACAC,IAAAA,YAAY,EAAGC,IAAD,IAAU;AACpBA,MAAAA,IAAI,CAAC,IAAD,EAAOL,WAAW,CAACA,WAAnB,CAAJ;AACH;AAL4B,GAAlB,CAAf;AAQA,SAAOC,MAAP;AACH;;AAED,OAAO,eAAeK,cAAf,CAA8BC,MAA9B,EAAsCP,WAAtC,EAAmD;AAEtD,QAAMC,MAAM,GAAGF,sBAAsB,CAACC,WAAD,CAArC;AAEA,QAAMQ,IAAI,GAAG,MAAMP,MAAM,CAACQ,GAAP,CAAW,MAAMF,MAAjB,EAAyBG,GAAzB,EAAnB;AAEA,SAAOF,IAAP;AACH;AAED,OAAO,eAAeG,YAAf,CAA4BJ,MAA5B,EAAoCP,WAApC,EAAiD;AAEpD,MAAIY,GAAG,GAAG,sCAAsCL,MAAtC,GAA+C,eAAzD;AAEA,SAAOM,KAAK,CAACD,GAAD,EAAM;AACdE,IAAAA,MAAM,EAAE,KADM;AAEdC,IAAAA,OAAO,EAAE;AACLC,MAAAA,aAAa,EAAE,YAAYhB,WAAW,CAACA,WADlC;AAEL,sBAAgB;AAFX;AAFK,GAAN,CAAZ;AAQH","sourcesContent":["var graph = require('@microsoft/microsoft-graph-client');\r\n\r\nfunction getAuthenticatedClient(accessToken) {\r\n    // Initialize Graph client\r\n    const client = graph.Client.init({\r\n        // Use the provided access token to authenticate\r\n        // requests\r\n        authProvider: (done) => {\r\n            done(null, accessToken.accessToken);\r\n        }\r\n    });\r\n\r\n    return client;\r\n}\r\n\r\nexport async function getUserDetails(userId, accessToken) {\r\n\r\n    const client = getAuthenticatedClient(accessToken);\r\n\r\n    const user = await client.api('/' + userId).get();\r\n\r\n    return user;\r\n}\r\n\r\nexport async function getUserPhoto(userId, accessToken) {\r\n\r\n    var url = 'https://graph.microsoft.com/v1.0/' + userId + '/photo/$value';\r\n\r\n    return fetch(url, {\r\n        method: 'GET',\r\n        headers: {\r\n            Authorization: 'Bearer ' + accessToken.accessToken,\r\n            'Content-Type': 'application/json',\r\n        },\r\n    });\r\n\r\n}\r\n"]},"metadata":{},"sourceType":"module"}